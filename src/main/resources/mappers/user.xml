<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
	    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="UserDAO">
	<!-- 로그인 -->
	<select id="selectMember" parameterType="String" resultMap="memberMap">
		select userid,
				userpw,
				enabled
		from user_member_tbl
		where userid = #{userid}
	</select>
	<resultMap type="java.util.Map" id="memberMap">
		<id property="username" column="userid"/>
		<result property="password" column="userpw"/>
		<result property="enabled" column="enabled"/>
		<association property="authority" column="userid" select="getAuthority"/>
	</resultMap>
	<select id="getAuthority" resultType="com.team.smart.security.config.UserGrantedAuthority">
		 SELECT a.comp_auth, c.comp_loc, c.comp_seq
		 FROM user_compauth_tbl a, t_contract_tbl c
		 WHERE a.userid = #{userid}
		 AND c.cont_seq = a.cont_seq
	</select>
	<!-- 로그인 -->
	
	<!-- 회원가입(회원등록) -->
	<insert id="signUpUser" parameterType="com.team.smart.vo.UserVO">
		insert into user_member_tbl(userid, userpw, name, email, hp) 
    	values(#{userid}, #{userpw}, #{name}, #{email}, #{hp})
	</insert>
	
	
</mapper>